#functions f, f1, and f2
f1<-function(x){(-(x[1]^2+x[2]^2-2)*(x[1]^2+x[2]^2-1)*(x[1]^2+x[2]^2)*(x[1]^2+x[2]^2+1)*(x[1]^2+x[2]^2+2))}
f2<-function(x){(2-sin(x[1]^2-x[2]^2)*cos(x[2]-exp(x[2])))}
f<-function(x){f1(x)*f2(x)
  z <- (-(x[1]^2+x[2]^2-2)*(x[1]^2+x[2]^2-1)*(x[1]^2+x[2]^2)*(x[1]^2+x[2]^2+1)*(x[1]^2+x[2]^2+2))*(2-sin(x[1]^2-x[2]^2)*cos(x[2]-exp(x[2])))
  if(is.nan(z)){
    z <- (-(x[1]^2+x[2]^2-2)*(x[1]^2+x[2]^2-1)*(x[1]^2+x[2]^2)*(x[1]^2+x[2]^2+1)*(x[1]^2+x[2]^2+2))
  }
    return (z)
}

#calculating grad_f
f1_x<-function(x){-2*x[1]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4)}
f1_y<-function(x){-2*x[2]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4)}
f2_x<-function(x){-2*x[1]*cos(exp(x[2])-x[2])*cos((x[1]^2)-(x[2]^2))}
f2_y<-function(x){-2*x[1]*cos(exp(x[2])-x[2])*cos((x[1]^2)-(x[2]^2))}
grad_f<-function(x){c(f1_x(x)*f2(x)+f1(x)*f2_x(x), f1_y(x)*f2(x)+f1(x)*f2_y(x))
  w <- (-2*x[1]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4))
  *(-2*x[1]*cos(exp(x[2])-x[2])*cos((x[1]^2)-(x[2]^2)))
    + (-2*x[1]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4))
  *(-2*x[1]*cos*(exp(x[2])-x[2])*cos((x[1]^2)-(x[2]^2))),
  (-2*x[2]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4))
  *(-2*x[1]*cos(exp(x[2])-x[2])*cos((x[1]^2)-(x[2]^2)))
  +(-2*x[1]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4))
  *(-2*x[1]*cos(exp(x[2])-x[2])*cos((x[1]^2)-(x[2]^2)))
  if(is.nan(w)){
    w <- (-2*x[1]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4))
    + (-2*x[1]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4)),
    (-2*x[2]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4))
    +(-2*x[1]*(5*(x[1]^8)+20*(x[1]^6)*(x[2]^2)+15*(x[1]^4)*(2*(x[2]^4)-1)+10*(x[1]^2)*(x[2]^2)*(2*(x[2]^4)-3)+5*(x[2]^8)-15*(x[2]^4)+4))
  }
  return(w)
}


x0<-cbind(runif(50, -1.5, 1.5), runif(50, -1.5, 1.5))

